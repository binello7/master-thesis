Extended Abstract
Fast early flood warning systems exploiting catchment specific behavior

Sebastiano Rusca, Juan Pablo Carbajal (Peter Molnar? Jörg Rieckermann?)

1. Abstract
Floods due to heavy rain are among the most destructive events in hydrology and their frequency has incremented over the last decades. 
Numerical models are the most useful tools to predict floods and trigger security measures or evacuations. However, the high complexity of these models hinders the use of detailed simulators for realtime early warning systems.

An early warning system should be capable of giving within seconds a prediction of whether, based on current conditions and meteorological forecast, an occurring rain event will result in major flooding or not, and if yes within how much time.
Fine tuned physically based simulators are able to produce trustworthy flood predictions but are unusable as early warning systems due to their high computational cost.
Fast surrogate models based on these simulators can yield results of the same order of accuracy with speed-up factors or the order of 10^5.

In this work, we present a methodology for developing such surrogate models of a detailed (non-linear shallow water equations) simulator[1].
The performance of the resulting emulator-based early flood warning system tailored for the catchment in question is discussed and analyzed.

2. Brief methodology
Experiment set-up
figure: synthetically generated mountainous topography

The general goal of our emulator is to take inputs related to a rain event and catchment situation and predict the
time it will take to observe a discharge from the catchment greater or equal to a predefined threshold discharged $Q_!$.
The threshold discharge is probided by a downstream region that is prone to flooding.
Hence the quantity of interest (QoI) is the time-to-threshold, $t_!$.
The emulator is built using two input parameters: rain intensity ($I$) and soil saturation ($\Delta\theta$). 
Simulations were run using FullSwof2D [REFXX] with different values of these paramters and response hydrographs of an $2km \times 2km$ synthetic catchment where recorded.

The rationaly behind the chosen paramters is that rain intensity is readily available from metheorological predictions, while soil saturation is used to incorporate the recent history of the catchmenth, e.g. if we there were several rain int he previous days the soil will be highly saturated.
Since the response hydrograph shape is indenpendent of rain duration, i.e. the effect of different rain duarations can be factored out
\begin{equation}
Q(t, I, \Delta\theta, d) \aprox Q_\infty(t, I, \Delta\theta) \Xi(t \leq d)
\end{equation}
\noindent where $Q$ is the response hydrograph, $t$ is the time variable, $d$ is the rain event duration and $\Xi(x)$ is the indicator function of the interval $[0,d]$.
The discharge for infinite rain duration $Q_\infty(\ldots)$ determines the QoI,
\begin{equation}
Q_\infty (t_!, I, \Delta\theta) - Q_\! = 0
\end{equation}
\noindent Although $Q_\infty$ is not available sufficiently long rain events (6h in our case) are enough for the aplication at hand.
This is because rain intensity is likely to change withinh 6h, and because high intensity rains of such duration can be considered \textit{extreme} for many regions.

figure: response hydrographs of the 50 different experiments

50 simulations were run with soil initial saturations in a range 0 – 1 [-] and rain intensities in a range 10 – 32 mm/h. As output response the outflow through the catchment bottom boundary was used. This is represented in the hydrographs of figure #.
The hydrographs show different responses depending on the soil initial saturation and the rain intensity which was applied to the topography. In some cases, in particular by heavy rain and high initial soil saturation values, the appearance of surface runoff is very rapid. In other cases this just happens after it has rained for hours or does not happen at all. 
The emulator we aim to build should be used as an early flood warning system. The variable which it is trying to predict is then the time at which a certain Qthhold, the maximum discharge for which the various hydraulic structure on the channel downstream of the catchment were dimensioned, is reached. As observable from the hydrographs this time can be very variable depending on the value of Qthhold or can never be reached.

3. Summary of results
Emulator
figure: emulator, training, test and validation data points

The time lag to reach the chosen Qthhold (here 10% of the measured Qmax) was extracted from the hydrographs and plotted as a function of the initial soil saturation value and rain intensity. Output for events never reaching Qthhold is 7h (420 min), which is longer than the rain event itself, meaning this discharge value is not reached within the event. The chosen emulator is a cubic interpolator of the training points. Different emulators were tested on the test points and the final emulator was then validated with the validation points. The validation points were used as a final test for the emulator, prediction for time to reach Qthhold under different conditions were made using the emulator and compared with the results given by the simulations. The emulator obtained shows a speed-up factor of 10^5. This means that the results obtained in 1h simulation can be produced by the emulator in 0.04s. The table here below shows the accuracy of the built emulator

              MAE (min, %)    RMSE (min)
test           5.8, 27.0        2.89
validation     11.8, 11.6       5.73

4. References
Bayarri, M. J., Berger, J. O., Calder, E. S., Patra, A. K., Pitman, E. B., Spiller, E. T., & Wolpert, R. L. (2015). Probabilistic Quantification Of Hazards: A Methodology Using Small Ensembles Of Physics-Based Simulations And Statistical Surrogates. International Journal for Uncertainty Quantification, 5(4), 297–325. DOI:10.1615/Int.J.UncertaintyQuantification.2015011451
